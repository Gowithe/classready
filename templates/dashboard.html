{% extends "base.html" %}

{% block title %}Dashboard - Teacher Platform{% endblock %}

{% block extra_css %}
<style>
  .dashboard-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom: 2rem;
    flex-wrap:wrap;
    gap: 12px;
  }
  .dashboard-header h2{ font-size: 2rem; }
  .cta-buttons{ display:flex; gap: 1rem; flex-wrap:wrap; }

  .section{ margin-bottom: 3rem; }
  .section h3{
    font-size: 1.3rem;
    margin-bottom: 1.0rem;
    color: #667eea;
    border-bottom: 2px solid #667eea;
    padding-bottom: 0.5rem;
  }

  .topic-grid{
    display:grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 1.2rem;
  }
  .topic-card{
    background:white;
    border-radius:10px;
    padding: 1.25rem;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    transition: all .2s;
  }
  .topic-card:hover{
    box-shadow: 0 10px 18px rgba(0,0,0,0.12);
    transform: translateY(-3px);
  }
  .topic-card h4{
    font-size: 1.05rem;
    margin-bottom: .4rem;
    color:#667eea;
  }
  .topic-card p{
    font-size:.9rem;
    color:#718096;
    margin-bottom: .9rem;
  }

  .topic-actions{
    display:flex;
    gap: .5rem;
    flex-wrap:wrap;
    margin-top: .5rem;
  }
  .topic-actions a, .topic-actions button{
    padding: .5rem .9rem;
    font-size: .85rem;
    background:#667eea;
    color:white;
    border-radius: 6px;
    text-decoration:none;
    border:none;
    cursor:pointer;
  }
  .topic-actions a:hover, .topic-actions button:hover{ background:#764ba2; }
  .danger{ background:#f56565 !important; }
  .danger:hover{ background:#e53e3e !important; }

  .recent-list{ list-style:none; padding:0; }
  .recent-list li{
    padding: 1rem;
    background:white;
    margin-bottom: .5rem;
    border-radius: 8px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }
  .recent-list a{ color:#667eea; text-decoration:none; font-weight:700; }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-header">
  <h2>Dashboard</h2>
  <div class="cta-buttons">
    <!-- Classroom Button -->
    <a href="{{ url_for('classrooms') }}" class="btn" style="background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:12px 20px;border-radius:12px;font-weight:700;text-decoration:none;">
      üè´ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
    </a>
    <a href="{{ url_for('my_create_topic') }}" class="btn">‚ûï Create My Topic</a>
    <a href="{{ url_for('ai_slides') }}" class="btn">‚ú® Generate Slides with AI</a>
    {% if session.role == 'admin' %}
      <a href="{{ url_for('admin_dashboard') }}" class="btn">‚öôÔ∏è Admin</a>
    {% endif %}
  </div>
</div>

<div class="section">
  <h3>Recent Topics</h3>
  {% if recent %}
    <ul class="recent-list">
      {% for item in recent %}
        <li>
          <span>{{ item.name }}</span>
          <a href="{{ url_for('topic_detail', topic_id=item.topic_id) }}">View</a>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p style="color:#718096;">No recent topics yet.</p>
  {% endif %}
</div>

<div class="section">
  <h3>My Topics</h3>
  {% if my_topics %}
    <div class="topic-grid">
      {% for topic in my_topics %}
      <div class="topic-card">
        <h4>üìö {{ topic.name }}</h4>
        <p>{{ topic.description or 'No description' }}</p>

        <div class="topic-actions">
          <a href="{{ url_for('topic_detail', topic_id=topic.id) }}">Open</a>
          <a href="{{ url_for('my_edit_topic', topic_id=topic.id) }}">Edit</a>
          <form method="POST" action="{{ url_for('my_delete_topic', topic_id=topic.id) }}" style="display:inline;">
            <button class="danger" onclick="return confirm('Delete this topic?');">Delete</button>
          </form>
        </div>

        <div class="topic-actions" style="margin-top:.6rem;">
          <a href="{{ url_for('view_slides', topic_id=topic.id) }}">Slides</a>
          <a href="{{ url_for('game', topic_id=topic.id) }}">Game</a>
          <a href="{{ url_for('practice', topic_id=topic.id) }}">Practice</a>
        </div>
      </div>
      {% endfor %}
    </div>
  {% else %}
    <p style="color:#718096;">You have no topics yet. Click ‚ÄúCreate My Topic‚Äù.</p>
  {% endif %}
</div>

{% if session.role == 'admin' %}
<div class="section">
  <h3>All Topics (Admin)</h3>
  {% if topics %}
    <div class="topic-grid">
      {% for topic in topics %}
      <div class="topic-card">
        <h4>üìñ {{ topic.name }}</h4>
        <p>{{ topic.description or 'No description' }}</p>
        <div class="topic-actions">
          <a href="{{ url_for('topic_detail', topic_id=topic.id) }}">Open</a>
          <a href="{{ url_for('view_slides', topic_id=topic.id) }}">Slides</a>
          <a href="{{ url_for('game', topic_id=topic.id) }}">Game</a>
          <a href="{{ url_for('practice', topic_id=topic.id) }}">Practice</a>
        </div>
      </div>
      {% endfor %}
    </div>
  {% else %}
    <p style="color:#718096;">No topics available yet.</p>
  {% endif %}
</div>
{% endif %}
{% endblock %}
